## 📖 Item2. 생성자에 매개변수가 많다면 빌더를 고려해라

---

**정적 팩토리와 생성자의 동일한 제약** <br/>
- 매개변수가 많을 시, 적절하게 대응하기 어려움

예시 - 영양정보 <br/>


1. 점층적 생성자 패턴<br/>
- 필수 매개변수와 선택 매개변수를 이용하여 생성자를 만듬
- 해당 클래스의 인스턴스를 만들려면 원하는 매개변수를 모두 포함한 생성자 중, 가장 짧은 것을 골라 호출함<br/>
-> 매개변수의 갯수가 많아지면 클라이언트 코드를 작성하거나 읽기가 어려움<br/>
<br/>
2. 자바 빈즈 패턴 <br/>
- 매개변수가 없는 생성자로 객체를 만든 후, 세터 메서드를 호출하여 원하는 매개변수의 값을 설정하는 방식<br/>
-> 코드가 길어지지만, 인스턴스를 만들기 쉽고, 더 읽기 좋은 코드가 됨
<br/>

**단점**
**- 자바빈즈 패턴에서는 객체 하나를 만들려면 메서드를 여러 개 호출해야 하고, 객체가 완전히 생성되기 전까지는 일관성이 무너진 상태가 됨** <br/>
-> 일관성이 무너지는 문제로 인해, 자바빈즈 패턴에서는 클래스를 불변으로 만들 수 없으며, 스레드 안정성을 얻으려면 프로그래머가 추가 작업을 해줘야 함

3. 빌더 패턴
- 클라이언트는 필요한 객체를 직접 만드는 대신, 필수 매개변수만으로 생성자를 호출하여 빌더 객체를 얻음
- 그 후, 빌더 객체가 제공하는 세터 메서드로 원하는 선택 매개변수를 설정함
- 매개변수가 없는 build 메소드를 호출하여 필요한 객체를 만듬
- 빌더는 생성할 클래스 안에 정적 클래스로 만들어두는 것이 보통임
<br/>
NutritionFacts 클래스는 불변이며, 모든 매개변수의 기본값들을 한 곳에 모아둠
- 빌더의 세터 메서드는 빌더 자신을 반환하기 때문에 연쇄적으로 호출할 수 있음
-> 플루언트 API 혹은 메서드 연쇄라고 함

**장점**
- 코드를 쓰기 쉽고, 읽기 쉬우며 빌더 패턴은 명명된 선택적 매개변수를 흉내냄
- 잘못된 매개변수를 최대한 일찍 발견하려면 빌더의 생성자와 메서드에서 입력 매개변수를 검사하고, build 메서드가 호출하는 생성자에서 여러 매개변수에 걸친 불변식을 검사함
- 불변식을 보장하려면 빌더로부터 매개변수를 복사한 후 해ㅔ당 객체 필드들도 검사해야 함 <br/>
-> 검사에서 잘못된 점을 발견하면 어떤 매개변수가 잘못되었는지를 자세히 알려주는 메시즈를 담아 IllegalArgumentException을 던지면 됨

- 빌더 패턴은 계층적으로 설계된 클래스와 함께 사용하기 좋음<br/>

예시 - 피자의 다양한 종류를 표현한 계층구조와 루트에 놓인 추상 클래스 
- 추상 클래스 - 추상빌더 
- 구체 클래스 - 구체 빌더

**코드 - Pizza, NyPizza,Calzone** <br/>
- 각 하위 클래스의 빌더가 정의한 build 메서드는 해당하는 구체 하위 클래스를 반환하도록 선언함
- NyPizza.Builder = NyPizza를 반환함
- Calzone.Builder = Calzone을 반환함

- 공변 반환 타이핑= 하위 클래스의 메서드가 상위 클래스의 메서드가 정의한 반환 타입이 아닌, 해당 하위 타입을 반환하는 기능 <br/>
-> 형 변환에 신경 쓰지 않고도 빌더를 사용할 수 있음<br/>
-> 계층형 빌더를 사용하는 클라언트는 앞서 살펴본 영향 정보 빌더를 사용하는 코드와 다르지 않음

- 빌더를 이용하면 가변 인수 매개변수를 여러 개 사용할 수 있음
- 각각을 적절한 메서드로 나누어 선언하면 됨
- 메서드를 여러 번 호출하게 할 수 있고, 각 호출에서 넘겨진 매개변수들을 하나의 필드로 모을 수도 있음
- 빌더 하나로 여러 객체를 순회하며 만들 수 있고, 빌더에 넘기는 매개변수에 따라 다른 객체를 만들 수 있음

**빌더 패턴의 단점**
- 객체를 만들려면, 빌더를 만들어야 함
- 매개변수가 4개 이상이 되어야만 값어치를 함


